<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
<meta name="baidu-site-verification" content="code-ipFSuNxhZV" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"alexiusll.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="å› ä¸ºé¡¹ç›®éœ€è¦ï¼Œç°åœ¨è¦åœ¨webä¸Šå®ç°ä¸€ä¸ªä½“ç»˜åˆ¶ï¼ˆVolume Renderingï¼‰ æœ¬æ–‡çš„å†…å®¹å°†ä¼šåŸºäºgithubé¡¹ç›®: https:&#x2F;&#x2F;github.com&#x2F;lebarba&#x2F;WebGLVolumeRendering å¤šæ•°å†…å®¹ç¿»è¯‘è‡ªæ–‡æ¡£ : http:&#x2F;&#x2F;www.lebarba.com&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="ä½¿ç”¨threejså®ç°ç®€å•çš„Volume Rendering">
<meta property="og:url" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/index.html">
<meta property="og:site_name" content="alexiusll çš„åšå®¢">
<meta property="og:description" content="å› ä¸ºé¡¹ç›®éœ€è¦ï¼Œç°åœ¨è¦åœ¨webä¸Šå®ç°ä¸€ä¸ªä½“ç»˜åˆ¶ï¼ˆVolume Renderingï¼‰ æœ¬æ–‡çš„å†…å®¹å°†ä¼šåŸºäºgithubé¡¹ç›®: https:&#x2F;&#x2F;github.com&#x2F;lebarba&#x2F;WebGLVolumeRendering å¤šæ•°å†…å®¹ç¿»è¯‘è‡ªæ–‡æ¡£ : http:&#x2F;&#x2F;www.lebarba.com&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/voxels.jpg">
<meta property="og:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/114.png">
<meta property="og:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/tu.jpg">
<meta property="og:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/rays.jpg">
<meta property="og:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/111.png">
<meta property="og:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/112.png">
<meta property="og:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/113.png">
<meta property="article:published_time" content="2021-07-14T08:35:05.000Z">
<meta property="article:modified_time" content="2021-07-18T16:41:27.316Z">
<meta property="article:author" content="alexiusll">
<meta property="article:tag" content="åŒ»å­¦å½±åƒå¤„ç†">
<meta property="article:tag" content="å‰ç«¯">
<meta property="article:tag" content="React">
<meta property="article:tag" content="threejs">
<meta property="article:tag" content="å›¾å½¢å­¦">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/voxels.jpg">

<link rel="canonical" href="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ä½¿ç”¨threejså®ç°ç®€å•çš„Volume Rendering | alexiusll çš„åšå®¢</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?80dbe2fa10c94d76691cf667b9e57694";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">alexiusll çš„åšå®¢</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">10</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">4</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">12</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://alexiusll.github.io/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/apple-touch-icon-next.png">
      <meta itemprop="name" content="alexiusll">
      <meta itemprop="description" content="alexiusll çš„åšå®¢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="alexiusll çš„åšå®¢">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ä½¿ç”¨threejså®ç°ç®€å•çš„Volume Rendering
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-07-14 16:35:05" itemprop="dateCreated datePublished" datetime="2021-07-14T16:35:05+08:00">2021-07-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8C%BB%E5%AD%A6%E5%BD%B1%E5%83%8F%E5%A4%84%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">åŒ»å­¦å½±åƒå¤„ç†</span></a>
                </span>
            </span>

          
            <span id="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/" class="post-meta-item leancloud_visitors" data-flag-title="ä½¿ç”¨threejså®ç°ç®€å•çš„Volume Rendering" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>11 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>å› ä¸ºé¡¹ç›®éœ€è¦ï¼Œç°åœ¨è¦åœ¨webä¸Šå®ç°ä¸€ä¸ªä½“ç»˜åˆ¶ï¼ˆVolume Renderingï¼‰</p>
<p>æœ¬æ–‡çš„å†…å®¹å°†ä¼šåŸºäºgithubé¡¹ç›®: <a target="_blank" rel="noopener" href="https://github.com/lebarba/WebGLVolumeRendering">https://github.com/lebarba/WebGLVolumeRendering</a></p>
<p>å¤šæ•°å†…å®¹ç¿»è¯‘è‡ªæ–‡æ¡£ : <a target="_blank" rel="noopener" href="http://www.lebarba.com/">http://www.lebarba.com/</a></p>
<span id="more"></span>

<h2 id="ğŸ“˜ä»€ä¹ˆæ˜¯ä½“ç»˜åˆ¶-Volume-Rendering"><a href="#ğŸ“˜ä»€ä¹ˆæ˜¯ä½“ç»˜åˆ¶-Volume-Rendering" class="headerlink" title="ğŸ“˜ä»€ä¹ˆæ˜¯ä½“ç»˜åˆ¶(Volume Rendering)?"></a>ğŸ“˜ä»€ä¹ˆæ˜¯ä½“ç»˜åˆ¶(Volume Rendering)?</h2><p>â€‹    ä¸ä¼ ç»Ÿçš„æ¸²æŸ“ä¸åŒï¼Œä½¿ç”¨ä¸‰è§’å½¢(triangles)æ¥æ˜¾ç¤º3Då›¾å½¢ï¼Œä½“æ¸²æŸ“ä½¿ç”¨å…¶ä»–æ–¹æ³•ï¼Œå¦‚ <strong>ä½“ç´ å…‰çº¿æŠ•å°„ç®—æ³•(Volume Ray Casting)</strong> ã€‚è¿™ç§åŸºäºå›¾åƒçš„æ–¹æ³•æ¸²æŸ“ä¸€ä¸ª3Dæ ‡é‡åœºï¼ˆscalar fieldï¼‰åˆ°ä¸€ä¸ª2Då›¾åƒé€šè¿‡æ²¿ç€3Dä½“ç´ æ¥æŠ•å°„å…‰çº¿ï¼ˆçœ‹ä¸æ‡‚â€¦ï¼‰ã€‚æˆ‘ä»¬åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„æ¯ä¸€ä¸ªåƒç´ æ˜¯å°„çº¿é€šè¿‡ç«‹æ–¹ä½“å¹¶ä»¥ä¸€å®šçš„é—´éš”ä»ä½“ç´ ä¸­è·å¾—å¼ºåº¦æ ·æœ¬çš„ç»“æœã€‚</p>
<p>â€‹    ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•æŠ•å°„å°„çº¿å‘¢?</p>
<p>â€‹    ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¤§å°ä¸º(1,1,1)3Dç½‘æ ¼ç«‹æ–¹ä½“ï¼Œå¹¶ä¸”æ¸²æŸ“æ­£é¢å’ŒèƒŒé¢(å¯ç”¨å’Œç¦ç”¨èƒŒé¢å‰”é™¤)åœ¨ä¸¤ä¸ªä¸åŒçš„æ¸²æŸ“é€šé“ã€‚</p>
<p>â€‹    å¯¹äºå±å¹•ä¸­ç”Ÿæˆçš„æ¯ä¸€ä¸ªç«‹æ–¹ä½“ç‰‡æ®µï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå°„çº¿ï¼Œä»ç«‹æ–¹ä½“çš„æ­£é¢å¼€å§‹ï¼Œåœ¨èƒŒé¢ç»“æŸã€‚æœ‰äº†å…‰çº¿çš„èµ·å§‹ç‚¹å’Œç»“æŸç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä»¥å›ºå®šçš„é—´éš”å¯¹ä½“ç´ è¿›è¡Œé‡‡æ ·ï¼Œä»¥ç”Ÿæˆç”Ÿæˆçš„ç‰‡æ®µé¢œè‰²ã€‚</p>
<p><img src="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/voxels.jpg" alt="voxels"></p>
<p>æ ‡é‡åœº (scalar field) ä»¥ä½“ç´ è¡¨ç¤ºï¼Œè¿™ä¸ªä½“ç´ åŒ…å«æ¯ä¸ª(x,y,z)ä½ç½®ä¸Šçš„å¼ºåº¦å€¼ï¼ˆintensity ï¼‰</p>
<h2 id="ğŸ’™ä¸€æ­¥ä¸€æ­¥åœ¨WebGLä¸­å®ç°"><a href="#ğŸ’™ä¸€æ­¥ä¸€æ­¥åœ¨WebGLä¸­å®ç°" class="headerlink" title="ğŸ’™ä¸€æ­¥ä¸€æ­¥åœ¨WebGLä¸­å®ç°"></a>ğŸ’™ä¸€æ­¥ä¸€æ­¥åœ¨WebGLä¸­å®ç°</h2><p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è§£é‡Šä½¿ç”¨WebGLå’ŒThreeJSå®ç°ä½“ç»˜åˆ¶çš„å®ç°æ­¥éª¤ã€‚</p>
<p>ï¼ˆæ ¹æ®é¡¹ç›®çš„å®é™…æƒ…å†µï¼Œå¯¹äºåŸæ–‡ä¸­çš„æ­¥éª¤æˆ‘ä¼šè¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œå¹¶ä¸”å®ç°æ–¹å¼ä¸º<strong>React + ThreeJs</strong>ï¼‰</p>
<h3 id="â‘ ç¬¬ä¸€æ­¥-å‡†å¤‡æ•°æ®"><a href="#â‘ ç¬¬ä¸€æ­¥-å‡†å¤‡æ•°æ®" class="headerlink" title="â‘ ç¬¬ä¸€æ­¥:å‡†å¤‡æ•°æ®"></a>â‘ ç¬¬ä¸€æ­¥:å‡†å¤‡æ•°æ®</h3><p>â€‹    <strong>åŸå§‹æ–‡ä»¶ Raw files</strong>ï¼ˆåæ–‡éƒ½å«Raw fIle) æ˜¯éå¸¸ç®€å•çš„æ–‡ä»¶ï¼ŒåªåŒ…å«ä½“ç´ å¼ºåº¦ï¼Œå®ƒä»¬æ²¡æœ‰å¤´éƒ¨ï¼ˆheadï¼‰æˆ–å…ƒæ•°æ®ï¼ˆmetadataï¼‰ï¼Œå®ƒä»¬é€šå¸¸æ˜¯ä¸€ä¸ª8bit æˆ–è€… 16bit çš„å¼ºåº¦å€¼ï¼Œæ¯ä¸ªä½“ç´ ä»¥X, Yå’ŒZçš„é¡ºåºæ’åˆ—ã€‚</p>
<p>â€‹    åœ¨OpenGLæˆ–DirectXä¸­ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿåœ¨3Dçº¹ç†ä¸­åŠ è½½æ‰€æœ‰è¿™äº›æ•°æ®ã€‚ä½†ç”±äºWebGLç›®å‰ä¸æ”¯æŒå­˜å‚¨æˆ–é‡‡æ ·3Dçº¹ç†ï¼Œæˆ‘ä»¬å¿…é¡»ä»¥ä¸€ç§å¯ç”¨äº2Dçº¹ç†çš„æ–¹å¼å­˜å‚¨å®ƒï¼ˆ**å®é™…ä¸Šç°åœ¨å¥½åƒå¯ä»¥äº†â€¦**ï¼‰ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬å¯ä»¥å­˜å‚¨ä¸€ä¸ªå¸¦æœ‰Zåˆ‡ç‰‡çš„pngå›¾åƒæ–‡ä»¶ï¼Œä»è€Œç”Ÿæˆ2Dåˆ‡ç‰‡çš„æ‹¼æ¥å›¾ã€‚æ–‡ç« ä½œè€…çš„å¼€å‘äº†ä¸€ä¸ªåŒ…å«æºä»£ç çš„æå…¶ç®€å•çš„è½¬æ¢å™¨å·¥å…·ã€‚è¯¥å·¥å…·ä½¿ç”¨åŸå§‹æ–‡ä»¶å¹¶ç”Ÿæˆä¸€ä¸ªpngå›¾åƒçš„æ‹¼æ¥ï¼Œåœ¨alphaé€šé“ä¸­ç¼–ç æ¯ä¸ªä½“ç´ çš„å¼ºåº¦(å°½ç®¡ç†æƒ³çš„æƒ…å†µæ˜¯å°†pngå­˜å‚¨ä¸ºA8æ ¼å¼ï¼Œåªæ˜¯ä¸ºäº†èŠ‚çœä¸€äº›ç©ºé—´)ã€‚</p>
<p>â€‹    ä¸€æ—¦pngæ–‡ä»¶ä½œä¸º2Dçº¹ç†åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„è‡ªå®šä¹‰sampleAs3DTextureå‡½æ•°å°†å…¶ä½œä¸º3Dçº¹ç†è¿›è¡Œé‡‡æ ·ã€‚</p>
<p>åŸæ–‡ä¸­çš„æ•°æ®æ ¼å¼ååˆ†æœ‰è¶£ï¼š</p>
<p><img src="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/114.png" alt="114"></p>
<p>è¿™é‡Œåªå±•ç¤ºéƒ¨åˆ†æ•°æ®â€¦å®é™…æ•°æ®å¤ªå¤§ï¼Œæœ‰å°†è¿‘5MB</p>
<p>å®ƒæ˜¯ç”±16 * 16 ä¸ªå›¾ç‰‡æ‹¼æ¥å¾—åˆ°çš„ï¼Œç±»ä¼¼åš2Dæ¸¸æˆçš„æ—¶å€™ï¼Œå°†å¤šä¸ªç´ ææ‹¼æ¥åˆ°ä¸€ä¸ªæè´¨ä¸Š</p>
<p>å› ä¸ºå®é™…ä¸Šç°åœ¨WebGlæ”¯æŒä¸‰ç»´çš„çº¹ç†æ•°æ®äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å»ç”Ÿæˆä¸€ä¸ªä¸‰ç»´çº¹ç†æ•°æ®æ¥ä½œä¸ºè¾“å…¥ã€‚</p>
<h4 id="æ–¹å¼1-ç›´æ¥ç”Ÿæˆåƒç´ æ•°æ®"><a href="#æ–¹å¼1-ç›´æ¥ç”Ÿæˆåƒç´ æ•°æ®" class="headerlink" title="æ–¹å¼1 ç›´æ¥ç”Ÿæˆåƒç´ æ•°æ®:"></a>æ–¹å¼1 ç›´æ¥ç”Ÿæˆåƒç´ æ•°æ®:</h4><p>ä½¿ç”¨javascriptæ¥ç”Ÿæˆä¸€ä¸ª <strong>Uint8Array</strong> çš„ <strong>TypedArray</strong></p>
<p>ç„¶ååœ¨å¾ªç¯éå†å®ƒï¼Œå¡«å……å®ƒçš„åƒç´ </p>
<p>æœ€åå°†è¿™ä¸ªæ•°ç»„ä¼ å…¥åˆ° THREE.DataTexture3D ä¸­ï¼Œç”Ÿæˆä¸€ä¸ªä¸‰ç»´çš„çº¹ç†</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a buffer with color data</span></span><br><span class="line"><span class="keyword">const</span> _width = <span class="number">512</span>;</span><br><span class="line"><span class="keyword">const</span> _height = <span class="number">512</span>;</span><br><span class="line"><span class="keyword">const</span> _depth = <span class="number">41</span>;</span><br><span class="line"><span class="keyword">const</span> size = _width * _height;</span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(<span class="number">4</span> * size * _depth);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; _depth; i += <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> color = <span class="keyword">new</span> THREE.Color(<span class="built_in">Math</span>.random(), <span class="built_in">Math</span>.random(), <span class="built_in">Math</span>.random());</span><br><span class="line">    <span class="keyword">const</span> r = <span class="built_in">Math</span>.floor(color.r * <span class="number">255</span>);</span><br><span class="line">    <span class="keyword">const</span> g = <span class="built_in">Math</span>.floor(color.g * <span class="number">255</span>);</span><br><span class="line">    <span class="keyword">const</span> b = <span class="built_in">Math</span>.floor(color.b * <span class="number">255</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; size; j += <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> stride = (i * size + j) * <span class="number">4</span>;</span><br><span class="line">        data[stride] = r;</span><br><span class="line">        data[stride + <span class="number">1</span>] = g;</span><br><span class="line">        data[stride + <span class="number">2</span>] = b;</span><br><span class="line">        data[stride + <span class="number">3</span>] = <span class="number">125</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> cubeTex = <span class="keyword">new</span> THREE.DataTexture3D(data, _width, _height, _depth);</span><br><span class="line">cubeTex.format = THREE.RGBAFormat;</span><br><span class="line">cubeTex.type = THREE.UnsignedByteType;</span><br><span class="line">cubeTex.minFilter = THREE.LinearFilter;</span><br><span class="line">cubeTex.magFilter = THREE.LinearFilter;</span><br><span class="line">cubeTex.unpackAlignment = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<h4 id="æ–¹å¼2-ä»DICOMæ–‡ä»¶ä¸­è·å–"><a href="#æ–¹å¼2-ä»DICOMæ–‡ä»¶ä¸­è·å–" class="headerlink" title="æ–¹å¼2 ä»DICOMæ–‡ä»¶ä¸­è·å–:"></a>æ–¹å¼2 ä»DICOMæ–‡ä»¶ä¸­è·å–:</h4><p>æ€è·¯æ˜¯é¦–å…ˆä»DICOMä¸­è·å–16bitçš„rawData</p>
<p>ç„¶åå°†16bitçš„æ•°æ®é€šè¿‡çª—å®½çª—ä½çš„ç®—æ³•è½¬ä¸º8bitçš„æ•°æ®</p>
<p>æœ€åå°†ç”Ÿæˆçš„8bitæ•°æ®ä¼ å…¥åˆ° THREE.DataTexture3D ä¸­ï¼Œç”Ÿæˆä¸€ä¸ªä¸‰ç»´çš„çº¹ç†</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–çœŸå®æ•°æ®</span></span><br><span class="line">   <span class="keyword">const</span> res = <span class="keyword">await</span> getDicomSeriesImageData(uuid);</span><br><span class="line">   <span class="keyword">if</span> (!res) <span class="keyword">return</span>;</span><br><span class="line">   <span class="keyword">const</span> &#123; WW, WL, dataArray, rescaleSlope, rescaleIntercept &#125; = store;</span><br><span class="line">   <span class="keyword">const</span> numPixels = store.xDim * store.yDim * store.zDim;</span><br><span class="line">   <span class="keyword">const</span> imgPixels = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(numPixels * <span class="number">4</span>);</span><br><span class="line">   <span class="keyword">if</span> (WW !== <span class="literal">null</span> &amp;&amp; WL !== <span class="literal">null</span>) &#123;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; store.zDim; j += <span class="number">1</span>) &#123;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; store.xDim * store.yDim; i += <span class="number">1</span>) &#123;</span><br><span class="line">         <span class="keyword">const</span> stride = (j * store.xDim * store.yDim + i) * <span class="number">4</span>;</span><br><span class="line">         <span class="comment">// NewValue = (RawPixelValue * RescaleSlope) + RescaleIntercept</span></span><br><span class="line">         <span class="comment">// U = m*SV + b</span></span><br><span class="line">         <span class="keyword">const</span> valScaled =</span><br><span class="line">           dataArray[j * store.xDim * store.yDim + i] * rescaleSlope + rescaleIntercept;</span><br><span class="line">         <span class="keyword">let</span> val = <span class="built_in">Math</span>.floor(((valScaled - WL + WW / <span class="number">2</span>) * <span class="number">255</span>) / WW);</span><br><span class="line">           </span><br><span class="line">         val = val &gt;= <span class="number">0</span> ? val : <span class="number">0</span>;</span><br><span class="line">         val = val &lt; <span class="number">255</span> ? val : <span class="number">255</span>;</span><br><span class="line">           </span><br><span class="line">         imgPixels[stride] = val;</span><br><span class="line">         imgPixels[stride + <span class="number">1</span>] = val;</span><br><span class="line">         imgPixels[stride + <span class="number">2</span>] = val;</span><br><span class="line">         imgPixels[stride + <span class="number">3</span>] = <span class="number">255</span>;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">const</span> imgTexture = <span class="keyword">new</span> THREE.DataTexture3D(imgPixels, store.xDim, store.yDim, store.zDim);</span><br><span class="line">   imgTexture.format = THREE.RGBAFormat;</span><br><span class="line">   imgTexture.type = THREE.UnsignedByteType;</span><br><span class="line">   imgTexture.minFilter = THREE.LinearFilter;</span><br><span class="line">   imgTexture.magFilter = THREE.LinearFilter;</span><br><span class="line">   imgTexture.unpackAlignment = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<h3 id="â‘¡ç¬¬äºŒæ­¥-ç¬¬ä¸€ä¸ªæ¸²æŸ“é€šé“"><a href="#â‘¡ç¬¬äºŒæ­¥-ç¬¬ä¸€ä¸ªæ¸²æŸ“é€šé“" class="headerlink" title="â‘¡ç¬¬äºŒæ­¥:ç¬¬ä¸€ä¸ªæ¸²æŸ“é€šé“"></a>â‘¡ç¬¬äºŒæ­¥:ç¬¬ä¸€ä¸ªæ¸²æŸ“é€šé“</h3><p>â€‹    åœ¨ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬æ‰“ç®—ç”Ÿæˆå¾ˆå¤šç‰‡æ®µï¼Œä½œä¸ºå°„çº¿çš„ç»ˆç‚¹ã€‚æ‰€ä»¥å¯¹äºç¬¬ä¸€ä¸ªæ¸²æŸ“é€šé“ï¼Œä¸ç»˜åˆ¶èƒŒé¢çš„é¢œè‰²ï¼Œæˆ‘ä»¬å°†ç‰‡æ®µçš„World-Spaceä½ç½®å­˜å‚¨åœ¨æ¸²æŸ“çº¹ç†ä¸­ï¼Œä½œä¸ºRGBç‰‡æ®µé¢œè‰²ä¸­çš„xã€yã€zåæ ‡å€¼(è¿™é‡ŒRGBè¢«ç¼–ç ä¸ºæµ®ç‚¹å€¼)ã€‚</p>
<p>â€‹    æ³¨æ„worldSpaceCoordsæ˜¯å¦‚ä½•ç”¨äºå­˜å‚¨ç«‹æ–¹ä½“èƒŒé¢ä½ç½®çš„ä¸–ç•Œç©ºé—´ä½ç½®çš„ã€‚</p>
<p><strong>å‰ç«¯ä»£ç ï¼ˆéƒ¨åˆ†ï¼‰</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> materialFirstPass = <span class="keyword">new</span> THREE.ShaderMaterial(&#123;</span><br><span class="line">    <span class="attr">vertexShader</span>: vertexShaderFirstPass,</span><br><span class="line">    <span class="attr">fragmentShader</span>: fragmentShaderFirstPass,</span><br><span class="line">    <span class="comment">// å®šä¹‰å°†è¦æ¸²æŸ“å“ªä¸€é¢ - æ­£é¢ï¼ŒèƒŒé¢æˆ–ä¸¤è€…</span></span><br><span class="line">    <span class="comment">// BackSideï¼ŒFrontSideï¼ŒDoubleSide</span></span><br><span class="line">    <span class="attr">side</span>: THREE.BackSide,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> boxGeometry = <span class="keyword">new</span> THREE.BoxGeometry(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line"><span class="keyword">const</span> meshFirstPass = <span class="keyword">new</span> THREE.Mesh(boxGeometry, materialFirstPass);</span><br><span class="line">scene.add(meshFirstPass);</span><br></pre></td></tr></table></figure>



<p><strong>é¡¶ç‚¹ç€è‰²å™¨ï¼š</strong></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> worldSpaceCoords;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Set the world space coordinates of the back faces vertices as output.</span></span><br><span class="line">    worldSpaceCoords = position + <span class="type">vec3</span>(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>); <span class="comment">//move it from [-0.5;0.5] to [0,1]</span></span><br><span class="line">    <span class="built_in">gl_Position</span> = projectionMatrix * modelViewMatrix * <span class="type">vec4</span>( position, <span class="number">1.0</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>ç‰‡æ®µç€è‰²å™¨</strong></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> worldSpaceCoords;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//The fragment&#x27;s world space coordinates as fragment output.</span></span><br><span class="line">    <span class="built_in">gl_FragColor</span> = <span class="type">vec4</span>( worldSpaceCoords.x , worldSpaceCoords.y, worldSpaceCoords.z, <span class="number">1</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨è§£ï¼š</strong></p>
<p><strong>varyingå˜é‡</strong> æ˜¯vertexå’Œfragment shaderä¹‹é—´åšæ•°æ®ä¼ é€’ç”¨çš„ã€‚</p>
<p><strong>position</strong> å“ªé‡Œæ¥çš„ï¼Ÿå†…ç½®çš„å˜é‡(uniforms)å’Œå±æ€§ åŒ…æ‹¬ï¼š</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// default vertex attributes provided by Geometry and BufferGeometry</span></span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> position;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec3</span> normal;</span><br><span class="line"><span class="keyword">attribute</span> <span class="type">vec2</span> uv;</span><br></pre></td></tr></table></figure>



<p><strong>æ¸²æŸ“ç»“æœ</strong></p>
<p><img src="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/tu.jpg" alt="tu"></p>
<p>â€‹                                                                            å·¦è¾¹æ˜¯ back side  å³è¾¹æ˜¯ Front side</p>
<h4 id="ä½¿ç”¨-WebGLRenderTarget-å»ºç«‹ç¼“å†²"><a href="#ä½¿ç”¨-WebGLRenderTarget-å»ºç«‹ç¼“å†²" class="headerlink" title="ä½¿ç”¨ WebGLRenderTarget å»ºç«‹ç¼“å†²"></a>ä½¿ç”¨ WebGLRenderTarget å»ºç«‹ç¼“å†²</h4><p>æ–‡æ¡£ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://threejs.org/docs/index.html?q=WebGLRenderTarget#api/zh/renderers/WebGLRenderTarget">https://threejs.org/docs/index.html?q=WebGLRenderTarget#api/zh/renderers/WebGLRenderTarget</a></p>
<p>render targetæ˜¯ä¸€ä¸ªç¼“å†²ï¼Œå°±æ˜¯åœ¨è¿™ä¸ªç¼“å†²ä¸­ï¼Œæ˜¾å¡ä¸ºæ­£åœ¨åå°æ¸²æŸ“çš„åœºæ™¯ç»˜åˆ¶åƒç´ ã€‚ å®ƒç”¨äºä¸åŒçš„æ•ˆæœï¼Œä¾‹å¦‚ç”¨äºåœ¨ä¸€ä¸ªå›¾åƒæ˜¾ç¤ºåœ¨å±å¹•ä¸Šä¹‹å‰å…ˆåšä¸€äº›å¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨NearestFilteræ¥æ¶ˆé™¤æ’å€¼.  åœ¨ cube é˜¶æ®µ, ç”Ÿæˆä¸–ç•Œåæ ‡æ’å€¼</span></span><br><span class="line"><span class="comment">// å°†åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­äº§ç”Ÿè™šå‡çš„å°„çº¿æ–¹å‘ï¼Œä»è€Œäº§ç”Ÿå¤–æ¥çš„é¢œè‰²ã€‚</span></span><br><span class="line"><span class="keyword">const</span> rtTexture = <span class="keyword">new</span> THREE.WebGLRenderTarget(width, height, &#123;</span><br><span class="line">    <span class="attr">minFilter</span>: THREE.NearestFilter,</span><br><span class="line">    <span class="attr">magFilter</span>: THREE.NearestFilter,</span><br><span class="line">    <span class="attr">wrapS</span>: THREE.ClampToEdgeWrapping,</span><br><span class="line">    <span class="attr">wrapT</span>: THREE.ClampToEdgeWrapping,</span><br><span class="line">    <span class="comment">// format: THREE.RGBFormat,</span></span><br><span class="line">    <span class="attr">type</span>: THREE.FloatType,</span><br><span class="line">    <span class="attr">generateMipmaps</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>å‚æ•°è¯¦è§£ï¼š</strong></p>
<p><strong>width</strong> - renderTargetçš„å®½åº¦<br><strong>height</strong> - renderTargetçš„é«˜åº¦</p>
<p>ğŸ¤options - (å¯é€‰)ä¸€ä¸ªä¿å­˜ç€è‡ªåŠ¨ç”Ÿæˆçš„ç›®æ ‡çº¹ç†çš„çº¹ç†å‚æ•°ä»¥åŠè¡¨ç¤ºæ˜¯å¦ä½¿ç”¨æ·±åº¦ç¼“å­˜/æ¨¡æ¿ç¼“å­˜çš„å¸ƒå°”å€¼çš„å¯¹è±¡ ä»¥ä¸‹æ˜¯ä¸€äº›åˆæ³•é€‰é¡¹ï¼š</p>
<p><strong>magFilter</strong> - é»˜è®¤æ˜¯LinearFilter. <strong>æ”¾å¤§æ»¤é•œ</strong><br><strong>minFilter</strong> - é»˜è®¤æ˜¯LinearFilter. <strong>ç¼©å°æ»¤é•œ</strong></p>
<p>è¿™2ä¸ªå‚æ•°ä»£è¡¨çº¹ç†çš„æ”¾å¤§å’Œç¼©å°ï¼Œè¿™é‡Œä½¿ç”¨ THREE.NearestFilter</p>
<p><strong>wrapS</strong> - é»˜è®¤æ˜¯ClampToEdgeWrapping.  <strong>åŒ…è£¹æ¨¡å¼</strong><br><strong>wrapT</strong> - é»˜è®¤æ˜¯ClampToEdgeWrapping. <strong>åŒ…è£¹æ¨¡å¼</strong></p>
<p>ä½¿ç”¨RepeatWrappingï¼Œçº¹ç†å°†ç®€å•åœ°é‡å¤åˆ°æ— ç©·å¤§ã€‚</p>
<p>ClampToEdgeWrappingæ˜¯é»˜è®¤å€¼ï¼Œçº¹ç†ä¸­çš„æœ€åä¸€ä¸ªåƒç´ å°†å»¶ä¼¸åˆ°ç½‘æ ¼çš„è¾¹ç¼˜ã€‚</p>
<p>ä½¿ç”¨MirroredRepeatWrappingï¼Œ çº¹ç†å°†é‡å¤åˆ°æ— ç©·å¤§ï¼Œåœ¨æ¯æ¬¡é‡å¤æ—¶å°†è¿›è¡Œé•œåƒã€‚</p>
<p><strong>format</strong> - é»˜è®¤æ˜¯RGBAFormat. <strong>çº¹ç†çš„æ ¼å¼</strong>  ç›®å‰æ¥çœ‹ï¼Œå¥½åƒå¿…é¡»è®¾ç½®æˆRGBAçš„æ ¼å¼ï¼Œè®¾ç½®æˆåˆ«çš„æ ¼å¼ä¼šæŠ¥warningï¼Ÿ</p>
<p><strong>type</strong> - é»˜è®¤æ˜¯UnsignedByteType. ç”¨äºçº¹ç†çš„typeå±æ€§ï¼Œè¿™äº›å±æ€§å¿…é¡»ä¸æ­£ç¡®çš„æ ¼å¼ç›¸å¯¹åº”ã€‚</p>
<p><strong>generateMipmaps</strong> - é»˜è®¤æ˜¯<strong>false</strong>.  <strong>æ˜¯å¦ç”Ÿæˆ Mipmaps</strong></p>
<h4 id="è¿›è¡Œæ¸²æŸ“ï¼Œè·å¾—ä¸€ä¸ªæè´¨çš„ç¼“å†²"><a href="#è¿›è¡Œæ¸²æŸ“ï¼Œè·å¾—ä¸€ä¸ªæè´¨çš„ç¼“å†²" class="headerlink" title="è¿›è¡Œæ¸²æŸ“ï¼Œè·å¾—ä¸€ä¸ªæè´¨çš„ç¼“å†²"></a>è¿›è¡Œæ¸²æŸ“ï¼Œè·å¾—ä¸€ä¸ªæè´¨çš„ç¼“å†²</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Render first pass and store the world space coords of the back face fragments into the texture.</span></span><br><span class="line">renderer.setRenderTarget(rtTexture);</span><br><span class="line">renderer.render(sceneFirstPass, camera);</span><br><span class="line">renderer.setRenderTarget(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨å‡½æ•°ï¼š</strong></p>
<p>**setRenderTarget **  è¯¥æ–¹æ³•è®¾ç½®æ´»è·ƒrendertargetã€‚</p>
<p><strong>( renderTarget : WebGLRenderTarget, activeCubeFace : Integer, activeMipmapLevel : Integer ) : null</strong></p>
<p><strong>renderTarget</strong> â€“ éœ€è¦è¢«æ¿€æ´»çš„renderTarget(å¯é€‰)ã€‚è‹¥æ­¤å‚æ•°ä¸ºç©ºï¼Œåˆ™å°†canvasè®¾ç½®æˆæ´»è·ƒrender targetã€‚<br><strong>activeCubeFace</strong> â€“ Specifies the active cube side (PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5) of WebGLCubeRenderTarget (optional).<br><strong>activeMipmapLevel</strong> â€“ Specifies the active mipmap level (optional).</p>
<h3 id="â‘¢ç¬¬ä¸‰æ­¥-ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“"><a href="#â‘¢ç¬¬ä¸‰æ­¥-ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“" class="headerlink" title="â‘¢ç¬¬ä¸‰æ­¥:ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“"></a>â‘¢ç¬¬ä¸‰æ­¥:ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“</h3><p>è¿™ä¸ªæ¸²æŸ“é€šé“å®é™…ä¸Šæ˜¯æ‰§è¡Œä½“ç§¯å…‰çº¿æŠ•å°„çš„ï¼Œå®ƒä»ç»˜åˆ¶ç«‹æ–¹ä½“çš„æ­£é¢å¼€å§‹ï¼Œæ­£é¢çš„æ¯ä¸ªç‚¹éƒ½æ˜¯å°„çº¿çš„èµ·ç‚¹ã€‚</p>
<p>é¡¶ç‚¹ç€è‰²å™¨åˆ›å»ºä¸¤ä¸ªè¾“å‡º:<strong>æŠ•å½±åæ ‡(ç‰‡æ®µçš„2Då±å¹•åæ ‡)(projectedCoords)</strong> å’Œ <strong>ä¸–ç•Œç©ºé—´åæ ‡ (worldSpaceCoords)</strong> ã€‚</p>
<p><strong>ä¸–ç•Œç©ºé—´åæ ‡</strong>å°†è¢«ç”¨ä½œå°„çº¿èµ·ç‚¹ï¼Œè€Œ<strong>æŠ•å½±åæ ‡</strong>å°†è¢«ç”¨äºé‡‡æ ·å­˜å‚¨ç«‹æ–¹ä½“èƒŒé¢ä½ç½®çš„çº¹ç†ã€‚</p>
<p><strong>vertexShaderSecondPass.vert</strong></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> worldSpaceCoords;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> projectedCoords;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    worldSpaceCoords = (modelMatrix * <span class="type">vec4</span>(position + <span class="type">vec3</span>(<span class="number">0.5</span>, <span class="number">0.5</span>,<span class="number">0.5</span>), <span class="number">1.0</span> )).xyz;</span><br><span class="line">    <span class="built_in">gl_Position</span> = projectionMatrix *  modelViewMatrix * <span class="type">vec4</span>( position, <span class="number">1.0</span> );</span><br><span class="line">    projectedCoords =  projectionMatrix * modelViewMatrix * <span class="type">vec4</span>( position, <span class="number">1.0</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨è§£</strong></p>
<p>è¿™é‡Œ gl_Position = projectedCoords éƒ½æ˜¯ç‰‡æ®µçš„2Då±å¹•åæ ‡</p>
<p>è€Œ worldSpaceCoords æ˜¯ä¸–ç•Œç©ºé—´åæ ‡ï¼ŒèŒƒå›´æ˜¯ ï¼ˆ0 -1ï¼‰çš„åŒºé—´</p>
<p>è¿™ä¸ªç‰‡æ®µç€è‰²å™¨çš„ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“æœ‰ç‚¹å¤æ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ…¢æ…¢åˆ†æè¿™ä¸ªéƒ¨åˆ†ã€‚</p>
<p><img src="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/rays.jpg" alt="rays"></p>
<p>â€‹    åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°„çº¿ R0 åˆ° R4 æ˜¯ä»ç«‹æ–¹ä½“æ­£é¢çš„ç‰‡æ®µä½ç½®æŠ•å°„çš„ ï¼ˆf0 åˆ° f4 ) ï¼Œç»“æŸåœ¨ç«‹æ–¹ä½“èƒŒé¢çš„ä½ç½®(I0åˆ°I4)</p>
<h4 id="å¾—åˆ°å°„çº¿çš„å‘é‡"><a href="#å¾—åˆ°å°„çº¿çš„å‘é‡" class="headerlink" title="å¾—åˆ°å°„çº¿çš„å‘é‡"></a>å¾—åˆ°å°„çº¿çš„å‘é‡</h4><p>åŸºäºä¸Šä¸€æ­¥çš„ä½ç½®ï¼Œæˆ‘ä»¬å¯¹çº¹ç†è¿›è¡Œé‡‡æ ·ï¼Œä»¥è·å¾—èƒŒé¢ç‰‡æ®µçš„ä¸–ç•Œç©ºé—´ä½ç½®ã€‚</p>
<p>æ³¨æ„æˆ‘ä»¬å¦‚ä½•é€šè¿‡é™¤ä»¥Wå°†æŠ•å½±åæ ‡è½¬æ¢ä¸ºNDC(æ ‡å‡†åŒ–è®¾å¤‡åæ ‡)ï¼Œç„¶åå¦‚ä½•å°†å…¶è½¬æ¢ä¸º[0;1]èŒƒå›´ï¼Œä»¥ä¾¿å°†å…¶ç”¨ä½œUVåæ ‡ã€‚å½“æˆ‘ä»¬å¯¹ä¹‹å‰æ¸²æŸ“é€šé“ä¸­ç”Ÿæˆçš„2Dçº¹ç†é‡‡æ ·æ—¶ï¼Œå°±å¾—åˆ°äº†å°„çº¿çš„ç»“æŸä½ç½®ã€‚</p>
<p><strong>fragmentShaderSecondPass.frag</strong></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†åæ ‡ä» vert shader ä¸­ä¼ å…¥</span></span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec3</span> worldSpaceCoords;</span><br><span class="line"><span class="keyword">varying</span> <span class="type">vec4</span> projectedCoords;</span><br><span class="line"></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">sampler2D</span> tex;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main( <span class="type">void</span> ) &#123;</span><br><span class="line">   <span class="comment">//è½¬æ¢å±å¹•ç©ºé—´åæ ‡ä» [-1;1] åˆ° [0;1]</span></span><br><span class="line">    <span class="type">vec2</span> texc = <span class="type">vec2</span>(((projectedCoords.x / projectedCoords.w) + <span class="number">1.0</span> ) / <span class="number">2.0</span>, ((projectedCoords.y / projectedCoords.w) + <span class="number">1.0</span> ) / <span class="number">2.0</span> );</span><br><span class="line">    <span class="comment">//åé¢çš„ä½ç½® æ˜¯ å­˜å‚¨åœ¨æè´¨ä¸­çš„ä¸–ç•Œç©ºé—´åæ ‡</span></span><br><span class="line">    <span class="type">vec3</span> backPos = <span class="built_in">texture</span>(tex, texc).xyz;</span><br><span class="line">    <span class="comment">//å‰é¢çš„ä½ç½® æ˜¯ ä¸–ç•Œç©ºé—´åæ ‡</span></span><br><span class="line">    <span class="type">vec3</span> frontPos = worldSpaceCoords;</span><br><span class="line">   <span class="comment">//ä»å‰é¢çš„ä½ç½® åˆ° åé¢çš„ä½ç½® çš„å‘é‡</span></span><br><span class="line">    <span class="type">vec3</span> dir = backPos - frontPos;</span><br><span class="line">    <span class="comment">// å°„çº¿é•¿åº¦</span></span><br><span class="line">    <span class="type">float</span> rayLength = <span class="built_in">length</span>(dir);</span><br><span class="line">	<span class="comment">// æµ‹è¯•ç”¨...</span></span><br><span class="line">    <span class="built_in">gl_FragColor</span> = <span class="type">vec4</span>( backPos.rgb, <span class="number">1.0</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¼€å¯æ­£é¢ç€è‰²çš„è¯ï¼Œå°±ä¼šåœ¨å±å¹•ä¸Šç»˜åˆ¶ç«‹æ–¹ä½“åé¢çš„ä½ç½®çš„åæ ‡ä¿¡æ¯ã€‚</p>
<h4 id="è®¾ç½®å°„çº¿"><a href="#è®¾ç½®å°„çº¿" class="headerlink" title="è®¾ç½®å°„çº¿"></a>è®¾ç½®å°„çº¿</h4><p>æœ‰äº†frontå’Œbackä½ç½®ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ›å»ºä¸€ä¸ªä»frontPoså¼€å§‹å¹¶ä»¥backPosç»“æŸçš„å°„çº¿ã€‚  </p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// step2</span></span><br><span class="line"><span class="comment">// è®¡ç®—æ­¥é•¿</span></span><br><span class="line"><span class="type">float</span> delta = <span class="number">1.0</span> / steps;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—é•¿åº¦</span></span><br><span class="line"><span class="type">vec3</span> deltaDirection = <span class="built_in">normalize</span>(dir) * delta;</span><br><span class="line"><span class="type">float</span> deltaDirectionLength = <span class="built_in">length</span>(deltaDirection);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°„çº¿ä» ç«‹æ–¹ä½“å‰é¢ä½ç½® å°„å…¥</span></span><br><span class="line"><span class="type">vec3</span> currentPosition = frontPos;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ä¸€ä¸ªé¢œè‰²çš„ç´¯ç§¯å™¨</span></span><br><span class="line"><span class="type">vec4</span> accumulatedColor = <span class="type">vec4</span>(<span class="number">0.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ä¸€ä¸ª Alpha çš„ç´¯ç§¯å™¨</span></span><br><span class="line"><span class="type">float</span> accumulatedAlpha = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°„çº¿ä¼ æ’­äº†å¤šé•¿çš„è·ç¦»</span></span><br><span class="line"><span class="type">float</span> accumulatedLength = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//If we have twice as many samples, we only need ~1/2 the alpha per sample.</span></span><br><span class="line"><span class="comment">//Scaling by 256/10 just happens to give a good value for the alphaCorrection slider.</span></span><br><span class="line"><span class="type">float</span> alphaScaleFactor = <span class="number">25.6</span> * delta;</span><br><span class="line"></span><br><span class="line"><span class="type">vec4</span> colorSample;</span><br><span class="line"><span class="type">float</span> alphaSample;</span><br></pre></td></tr></table></figure>



<h4 id="å°„çº¿å‘å°„"><a href="#å°„çº¿å‘å°„" class="headerlink" title="å°„çº¿å‘å°„"></a>å°„çº¿å‘å°„</h4><p>ä¸€æ—¦å°„çº¿è¢«è®¾ç½®å¥½ï¼Œæˆ‘ä»¬çš„å°„çº¿å°†ä»èµ·å§‹ä½ç½®ï¼Œæ¨è¿›å°„çº¿çš„å½“å‰ä½ç½®åˆ° <strong>dir</strong> ã€‚</p>
<p>åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å¯¹çº¹ç†è¿›è¡Œé‡‡æ ·ï¼Œä»¥å¯»æ‰¾ä½“ç´ å¼ºåº¦ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½“ç´ åªåŒ…å«å¼ºåº¦å€¼ï¼Œå› æ­¤åˆ°ç›®å‰ä¸ºæ­¢å®ƒä»¬è¿˜æ²¡æœ‰å…³äºé¢œè‰²çš„ä»»ä½•ä¿¡æ¯ã€‚èµ‹äºˆæ¯ä¸ªä½“ç´ é¢œè‰²çš„æ˜¯<strong>å˜æ¢å‡½æ•° <strong>ï¼ˆ</strong>transform function</strong> ï¼‰ã€‚å¯ä»¥çœ‹çœ‹ <strong>sampleAs3DTexture</strong> å‡½æ•°ä»£ç ï¼Œçœ‹çœ‹è½¬æ¢å‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<p>åœ¨æˆ‘ä»¬æœ‰äº†ç”±sampleAs3DTextureç»™å‡ºçš„ä½“ç´ é¢œè‰²åï¼Œå®ƒä¼šè¢« <strong>alphaCorrection</strong> å‚æ•°æ ¡æ­£ã€‚ä½ å¯ä»¥åœ¨çº¿è°ƒæ•´è¿™ä¸ªå€¼ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆä¸åŒçš„ç»“æœã€‚</p>
<p>æ¯æ¬¡è¿­ä»£çš„é‡è¦éƒ¨åˆ†æ˜¯å®é™…çš„é¢œè‰²æ„æˆï¼Œåœ¨è¿™é‡Œï¼Œ<strong>accumulatedColor</strong> å€¼è¢«æ·»åŠ åˆ°ä¹‹å‰å­˜å‚¨çš„åŸºäºalphaå€¼çš„å€¼ä¹‹ä¸Šã€‚æˆ‘ä»¬è¿˜ä¿å­˜äº†ä¸€ä¸ª<strong>alphaAccumulator</strong>ï¼Œå®ƒå°†è®©æˆ‘ä»¬çŸ¥é“ä½•æ—¶åœæ­¢å°„çº¿çš„å‰è¿›ã€‚</p>
<p>è¿­ä»£ä¼šä¸€ç›´è¿›è¡Œï¼Œç›´åˆ°æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ä¹‹ä¸€:</p>
<ul>
<li>å°„çº¿èµ°è¿‡çš„è·ç¦»è¾¾åˆ°äº†å‡å®šçš„å°„çº¿é•¿åº¦ã€‚è®°ä½ï¼Œå°„çº¿æ˜¯ä»startPosåˆ°endPosã€‚</li>
<li>ç´¯è®¡alphaå€¼è¾¾åˆ°100%</li>
<li>è¿­ä»£è¾¾åˆ°æœ€å¤§å¸¸æ•° MAX_STEPS ï¼ˆæœ¬ä¾‹ä¸­ï¼Œç”±äºç”Ÿæˆçš„ä½“ç´ æ•°æ®ä¸º512 * 512 * 512 çš„ï¼Œæ‰€ä»¥MAX_STEPS è®¾ç½®ä¸º 512å€çš„æ ¹å·ä¸‰ï¼Œçº¦ç­‰äº887)</li>
</ul>
<p>æœ€åï¼Œç‰‡æ®µç€è‰²å™¨è¿”å›è¢«éå†çš„ä½“ç´ å€¼çš„åˆæˆç»“æœã€‚</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// step3</span></span><br><span class="line"><span class="comment">// æ‰§è¡Œå°„çº¿å‰è¿›çš„è¿­ä»£</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAX_STEPS; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä»3Dçº¹ç†ä¸­è·å¾—ä½“ç´ å¼ºåº¦å€¼ã€‚</span></span><br><span class="line">    colorSample = getTexture(currentPosition);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// alphaæ ¡æ­£</span></span><br><span class="line">    alphaSample = colorSample.a * alphaCorrection;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è¿™ç§æ•ˆæœåº”ç”¨äºé¢œè‰²å’Œalphaç§¯ç´¯ï¼Œå¯ä»¥è·å¾—æ›´çœŸå®çš„é€æ˜åº¦ã€‚</span></span><br><span class="line">    alphaSample *= (<span class="number">1.0</span> - accumulatedAlpha);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‰æ­¥é•¿ç¼©æ”¾alpha ä½¿æœ€ç»ˆé¢œè‰²ä¸å—æ­¥é•¿å½±å“ã€‚</span></span><br><span class="line">    alphaSample *= alphaScaleFactor;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰§è¡Œåˆæˆ</span></span><br><span class="line">    accumulatedColor += colorSample * alphaSample;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨åˆ°ç›®å‰ä¸ºæ­¢ç§¯ç´¯çš„alphaã€‚</span></span><br><span class="line">    accumulatedAlpha += alphaSample;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨è¿›å°„çº¿</span></span><br><span class="line">    currentPosition += deltaDirection;</span><br><span class="line">    accumulatedLength += deltaDirectionLength;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœéå†çš„é•¿åº¦å¤§äºå°„çº¿é•¿åº¦ï¼Œæˆ–è€…ç´¯è®¡çš„alphaè¾¾åˆ°1.0ï¼Œé‚£ä¹ˆé€€å‡ºã€‚</span></span><br><span class="line">    <span class="keyword">if</span>(accumulatedLength &gt;= rayLength || accumulatedAlpha &gt;= <span class="number">1.0</span> )</span><br><span class="line">    	<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ”¹å˜æ§åˆ¶é¢æ¿ä¸­çš„ <strong>steps</strong> ï¼Œå¯ä»¥æ”¹å˜æ¯æ¡å°„çº¿çš„æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œå¯èƒ½éœ€è¦ç›¸åº”åœ°è°ƒæ•´ <strong>alphaCorrection</strong> å€¼ã€‚</p>
<p><strong>æ³¨è§£ï¼š</strong></p>
<p><strong>æ¯æ¬¡è¿­ä»£çš„æ­¥éª¤ï¼š</strong></p>
<ol>
<li> ä»3Dçº¹ç†ä¸­è·å¾—ä½“ç´ å¼ºåº¦å€¼ã€‚ï¼ˆè¿™ä¸€æ­¥åˆ©ç”¨å‡½æ•° getTexture å®é™…ä¸Šæ˜¯ä»è½¬æ¢æ–¹ç¨‹ä¸­è·å–åˆ°é¢œè‰²å€¼ï¼‰</li>
<li> alphaæ ¡æ­£ï¼Œè¿™é‡Œé»˜è®¤ alphaCorrection çš„å€¼è®¾ç½®ä¸º <strong>0.1</strong> ï¼ˆå³å®é™…æ‹¿åˆ°çš„ RGBAé¢œè‰² çš„ alpha å€¼ï¼Œå–å®ƒçš„ååˆ†ä¹‹ä¸€ï¼‰</li>
<li>è·å–åˆ°çš„ alphaå€¼ ï¼Œè¿˜è¦ä¹˜ä»¥ <strong>(1.0 - accumulatedAlpha)</strong> ï¼Œå³è¶Šå¾€åçš„åƒç´ ç‚¹ï¼Œå¯¹äº alphaç´¯è®¡å€¼ çš„å½±å“è¶Šå°</li>
<li>å†å°† alpha çš„å€¼ä¹˜ä»¥ <strong>alphaScaleFactor</strong> ï¼ŒæŒ‰æ­¥é•¿ç¼©æ”¾ alpha ä½¿æœ€ç»ˆé¢œè‰²ä¸å—æ­¥é•¿å½±å“ã€‚</li>
<li>æ‰§è¡Œåˆæˆ ï¼š accumulatedColor += colorSample * alphaSample;</li>
<li>å­˜å‚¨åˆ°ç›®å‰ä¸ºæ­¢ç§¯ç´¯çš„alphaï¼š accumulatedAlpha += alphaSample;</li>
<li>æ¨è¿›å°„çº¿</li>
</ol>
<h3 id="â‘£æ¸²æŸ“ç»“æœï¼š"><a href="#â‘£æ¸²æŸ“ç»“æœï¼š" class="headerlink" title="â‘£æ¸²æŸ“ç»“æœï¼š"></a>â‘£æ¸²æŸ“ç»“æœï¼š</h3><p>ç›´æ¥æ¸²æŸ“å‡ºæ¥æ•ˆæœå¾ˆå·®ï¼Œæ€§èƒ½è¡¨ç°ä¹Ÿå¾ˆä¸€èˆ¬ï¼Œåç»­éœ€è¦æŒç»­ä¼˜åŒ–ã€‚</p>
<p><img src="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/111.png" alt="æ¸²æŸ“ç»“æœ"></p>
<h2 id="ğŸ’œè¡¥å……å†…å®¹"><a href="#ğŸ’œè¡¥å……å†…å®¹" class="headerlink" title="ğŸ’œè¡¥å……å†…å®¹"></a>ğŸ’œè¡¥å……å†…å®¹</h2><h3 id="å¦‚ä½•è®¾ç½®è½¬æ¢æ–¹ç¨‹ï¼Ÿ"><a href="#å¦‚ä½•è®¾ç½®è½¬æ¢æ–¹ç¨‹ï¼Ÿ" class="headerlink" title="å¦‚ä½•è®¾ç½®è½¬æ¢æ–¹ç¨‹ï¼Ÿ"></a>å¦‚ä½•è®¾ç½®è½¬æ¢æ–¹ç¨‹ï¼Ÿ</h3><p>é¦–å…ˆè®¾ç½®3ç§é¢œè‰²çš„æ•°æ®ï¼Œå’Œå®ƒçš„åœ¨ 0-1 åŒºé—´ä¸Šçš„ä½ç½® ä½ç½®</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [colorSetting, setColorSetting] = useState([</span><br><span class="line">  &#123; <span class="attr">color</span>: <span class="string">&#x27;#00fa58&#x27;</span>, <span class="attr">stepPos</span>: <span class="number">0.1</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">color</span>: <span class="string">&#x27;#cc6600&#x27;</span>, <span class="attr">stepPos</span>: <span class="number">0.7</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">color</span>: <span class="string">&#x27;#f2f200&#x27;</span>, <span class="attr">stepPos</span>: <span class="number">1</span> &#125;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨canvasæ¥ç”Ÿæˆ è½¬æ¢æ–¹ç¨‹ çš„å›¾ç‰‡</p>
<p>å®ƒå°†ç”Ÿæˆä¸ºä¸€ä¸ª three.js ä¸­çš„æè´¨æ•°æ®</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> updateTransferFunction = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;colorSetting&#x27;</span>, colorSetting);</span><br><span class="line">  <span class="keyword">const</span> tfCanvasDom = tfCanvas.current;</span><br><span class="line"></span><br><span class="line">  tfCanvasDom.height = <span class="number">20</span>;</span><br><span class="line">  tfCanvasDom.width = <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> ctx = tfCanvasDom.getContext(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> grd = ctx.createLinearGradient(<span class="number">0</span>, <span class="number">0</span>, tfCanvasDom.width - <span class="number">1</span>, tfCanvasDom.height - <span class="number">1</span>);</span><br><span class="line">  grd.addColorStop(colorSetting[<span class="number">0</span>].stepPos, colorSetting[<span class="number">0</span>].color);</span><br><span class="line">  grd.addColorStop(colorSetting[<span class="number">1</span>].stepPos, colorSetting[<span class="number">1</span>].color);</span><br><span class="line">  grd.addColorStop(colorSetting[<span class="number">2</span>].stepPos, colorSetting[<span class="number">2</span>].color);</span><br><span class="line"></span><br><span class="line">  ctx.fillStyle = grd;</span><br><span class="line">  ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, tfCanvasDom.width - <span class="number">1</span>, tfCanvasDom.height - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> transferTexture = <span class="keyword">new</span> THREE.Texture(tfCanvasDom);</span><br><span class="line">  transferTexture.wrapS = THREE.ClampToEdgeWrapping;</span><br><span class="line">  transferTexture.wrapT = THREE.ClampToEdgeWrapping;</span><br><span class="line">  transferTexture.needsUpdate = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> transferTexture;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æœ€åä»¥uniformçš„å½¢å¼ä¼ å…¥åˆ°ç‰‡å…ƒç€è‰²å™¨ä¸­</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">vec4</span> getTexture( <span class="type">vec3</span> texCoord )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">vec4</span> colorSample = <span class="built_in">texture</span>(cubeTex , texCoord);</span><br><span class="line">    <span class="type">vec3</span> color = <span class="built_in">texture</span>( transferTex, <span class="type">vec2</span>( colorSample.r, <span class="number">1.0</span>) ).rgb;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">vec4</span>(color , colorSample.a) ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è¿™é‡Œ getTexture çš„æ–¹æ³•åœ¨ä¸Šæ–‡çš„ <strong>å°„çº¿å‘å°„</strong> ä¸­æœ‰ä½¿ç”¨åˆ°ï¼Œå³å®ƒçš„é¢œè‰²æ•°æ®ä» è‰²å½©è½¬æ¢æ–¹ç¨‹ä¸­è·å–</p>
<p>è¿™é‡Œå–è‰²çš„æ—¶å€™ï¼ŒYè½´å¯ä»¥ç›´æ¥å–1.0ï¼Œå› ä¸ºè¿™ä¸ªæè´¨åœ¨xåæ ‡ç›¸åŒçš„æ—¶å€™é¢œè‰²ä¸€è‡´ã€‚Xè½´ï¼Œå–colorSampleä¸­rgbä»»æ„ä¸€ä¸ªé€šé“çš„å€¼ã€‚</p>
<h3 id="ä¼˜åŒ–1ï¼šè§£å†³ç«‹æ–¹ä½“è¾¹ç¼˜çš„é”™è¯¯"><a href="#ä¼˜åŒ–1ï¼šè§£å†³ç«‹æ–¹ä½“è¾¹ç¼˜çš„é”™è¯¯" class="headerlink" title="ä¼˜åŒ–1ï¼šè§£å†³ç«‹æ–¹ä½“è¾¹ç¼˜çš„é”™è¯¯"></a>ä¼˜åŒ–1ï¼šè§£å†³ç«‹æ–¹ä½“è¾¹ç¼˜çš„é”™è¯¯</h3><p>æˆ‘ä»¬è·å–åˆ°çš„ç¬¬ä¸€ä¸ªæ¸²æŸ“ç»“æœï¼Œæœ‰ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é—®é¢˜å°±æ˜¯å®ƒçš„è¾¹ç¼˜ä¼šå‡ºç°ä¸€äº› â€ä¸æ­£ç¡®çš„åƒç´ â€œ</p>
<p>è§£å†³æ–¹æ¡ˆï¼šæ”¹å˜ ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“ çš„ ç‰‡å…ƒç€è‰²å™¨</p>
<p>è¿‡æ»¤æ‰è¾¹ç¼˜çš„ç‚¹ä¸è¿›è¡Œæ¸²æŸ“</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Using NearestFilter for rtTexture mostly eliminates bad backPos values at the edges</span></span><br><span class="line"><span class="comment">//of the cube, but there may still be no valid backPos value for the current fragment.</span></span><br><span class="line"><span class="keyword">if</span> ((backPos.x == <span class="number">0.0</span>) &amp;&amp; (backPos.y == <span class="number">0.0</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_FragColor</span> = <span class="type">vec4</span>(<span class="number">0.0</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ•ˆæœï¼š</strong></p>
<p><img src="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/112.png" alt="112"></p>
<h3 id="ä¼˜åŒ–2ï¼šè¿‡æ»¤æ‰ä¸€äº›å¤ªé»‘çš„åƒç´ "><a href="#ä¼˜åŒ–2ï¼šè¿‡æ»¤æ‰ä¸€äº›å¤ªé»‘çš„åƒç´ " class="headerlink" title="ä¼˜åŒ–2ï¼šè¿‡æ»¤æ‰ä¸€äº›å¤ªé»‘çš„åƒç´ "></a>ä¼˜åŒ–2ï¼šè¿‡æ»¤æ‰ä¸€äº›å¤ªé»‘çš„åƒç´ </h3><p>ç›®å‰å­˜åœ¨çš„é—®é¢˜çš„æ˜¯ï¼Œæ‰€æœ‰çš„åƒç´ çš„alphaéƒ½è®¾ç½®ä¸ºäº†255ï¼Œäºæ˜¯ä¸€äº›å¾ˆé»‘çš„åƒç´ å¯èƒ½ä¼šé®æŒ¡è§†é‡ï¼Œå¯¼è‡´æ¸²æŸ“çš„ç»“æœçœ‹èµ·æ¥å¾ˆåƒä¸€ä¸ªç«‹æ–¹ä½“ã€‚</p>
<p>æ€è·¯ï¼šå°†åƒç´ çš„ <strong>alpha</strong> å€¼ è®¾ç½®ä¸ºå®ƒçš„ç°åº¦å€¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">imgPixels[stride] = val;</span><br><span class="line">imgPixels[stride + <span class="number">1</span>] = val;</span><br><span class="line">imgPixels[stride + <span class="number">2</span>] = val;</span><br><span class="line">imgPixels[stride + <span class="number">3</span>] = val;</span><br></pre></td></tr></table></figure>

<p><strong>æ•ˆæœï¼š</strong></p>
<p><img src="/2021-07-14-%E4%BD%BF%E7%94%A8threejs%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84Volume-Rendering/113.png" alt="113"></p>
<h3 id="åç»­ä¼˜åŒ–â€¦"><a href="#åç»­ä¼˜åŒ–â€¦" class="headerlink" title="åç»­ä¼˜åŒ–â€¦"></a>åç»­ä¼˜åŒ–â€¦</h3><p>ç›®å‰æ¸²æŸ“å‡ºæ¥çš„å½±åƒï¼Œç”±äºåŸæ•°æ®åªæœ‰41å±‚ï¼Œå±‚æ•°æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥é”¯é½¿æ„Ÿå¾ˆå¼ºï¼Œè¦æ¶ˆé™¤é”¯é½¿ã€‚</p>
<p>æ¸²æŸ“æ•ˆç‡å¾ˆä½ï¼Œå½“stepså€¼è®¾ç½®å¾ˆé«˜çš„æ—¶å€™ï¼Œæ¸²æŸ“é€Ÿåº¦ä¼šå¾ˆå¡ï¼Œè¿˜éœ€è¦ç»§ç»­ä¼˜åŒ–ç®—æ³•</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%8C%BB%E5%AD%A6%E5%BD%B1%E5%83%8F%E5%A4%84%E7%90%86/" rel="tag"># åŒ»å­¦å½±åƒå¤„ç†</a>
              <a href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag"># å‰ç«¯</a>
              <a href="/tags/React/" rel="tag"># React</a>
              <a href="/tags/threejs/" rel="tag"># threejs</a>
              <a href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" rel="tag"># å›¾å½¢å­¦</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021-07-04-%E8%AE%B0%E5%BD%95%E4%BD%BF%E7%94%A8react%E5%86%99%E7%BB%84%E4%BB%B6%EF%BC%8C%E7%84%B6%E5%90%8E%E5%8F%91%E5%B8%83%E5%88%B0NPM/" rel="prev" title="è®°å½•ä½¿ç”¨reactå†™ç»„ä»¶ï¼Œç„¶åå‘å¸ƒåˆ°NPM">
      <i class="fa fa-chevron-left"></i> è®°å½•ä½¿ç”¨reactå†™ç»„ä»¶ï¼Œç„¶åå‘å¸ƒåˆ°NPM
    </a></div>
      <div class="post-nav-item">
    <a href="/2021-07-15-three-js%E4%B8%ADglsl%E5%86%99%E6%B3%95%E6%95%B4%E7%90%8601/" rel="next" title="three.jsä¸­glslå†™æ³•æ•´ç†01">
      three.jsä¸­glslå†™æ³•æ•´ç†01 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%98%E4%BB%80%E4%B9%88%E6%98%AF%E4%BD%93%E7%BB%98%E5%88%B6-Volume-Rendering"><span class="nav-number">1.</span> <span class="nav-text">ğŸ“˜ä»€ä¹ˆæ˜¯ä½“ç»˜åˆ¶(Volume Rendering)?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%92%99%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%9C%A8WebGL%E4%B8%AD%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.</span> <span class="nav-text">ğŸ’™ä¸€æ­¥ä¸€æ­¥åœ¨WebGLä¸­å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%91%A0%E7%AC%AC%E4%B8%80%E6%AD%A5-%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE"><span class="nav-number">2.1.</span> <span class="nav-text">â‘ ç¬¬ä¸€æ­¥:å‡†å¤‡æ•°æ®</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F1-%E7%9B%B4%E6%8E%A5%E7%94%9F%E6%88%90%E5%83%8F%E7%B4%A0%E6%95%B0%E6%8D%AE"><span class="nav-number">2.1.1.</span> <span class="nav-text">æ–¹å¼1 ç›´æ¥ç”Ÿæˆåƒç´ æ•°æ®:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F2-%E4%BB%8EDICOM%E6%96%87%E4%BB%B6%E4%B8%AD%E8%8E%B7%E5%8F%96"><span class="nav-number">2.1.2.</span> <span class="nav-text">æ–¹å¼2 ä»DICOMæ–‡ä»¶ä¸­è·å–:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%91%A1%E7%AC%AC%E4%BA%8C%E6%AD%A5-%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%B8%B2%E6%9F%93%E9%80%9A%E9%81%93"><span class="nav-number">2.2.</span> <span class="nav-text">â‘¡ç¬¬äºŒæ­¥:ç¬¬ä¸€ä¸ªæ¸²æŸ“é€šé“</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-WebGLRenderTarget-%E5%BB%BA%E7%AB%8B%E7%BC%93%E5%86%B2"><span class="nav-number">2.2.1.</span> <span class="nav-text">ä½¿ç”¨ WebGLRenderTarget å»ºç«‹ç¼“å†²</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E8%A1%8C%E6%B8%B2%E6%9F%93%EF%BC%8C%E8%8E%B7%E5%BE%97%E4%B8%80%E4%B8%AA%E6%9D%90%E8%B4%A8%E7%9A%84%E7%BC%93%E5%86%B2"><span class="nav-number">2.2.2.</span> <span class="nav-text">è¿›è¡Œæ¸²æŸ“ï¼Œè·å¾—ä¸€ä¸ªæè´¨çš„ç¼“å†²</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%91%A2%E7%AC%AC%E4%B8%89%E6%AD%A5-%E7%AC%AC%E4%BA%8C%E4%B8%AA%E6%B8%B2%E6%9F%93%E9%80%9A%E9%81%93"><span class="nav-number">2.3.</span> <span class="nav-text">â‘¢ç¬¬ä¸‰æ­¥:ç¬¬äºŒä¸ªæ¸²æŸ“é€šé“</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%97%E5%88%B0%E5%B0%84%E7%BA%BF%E7%9A%84%E5%90%91%E9%87%8F"><span class="nav-number">2.3.1.</span> <span class="nav-text">å¾—åˆ°å°„çº¿çš„å‘é‡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%B0%84%E7%BA%BF"><span class="nav-number">2.3.2.</span> <span class="nav-text">è®¾ç½®å°„çº¿</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%84%E7%BA%BF%E5%8F%91%E5%B0%84"><span class="nav-number">2.3.3.</span> <span class="nav-text">å°„çº¿å‘å°„</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%91%A3%E6%B8%B2%E6%9F%93%E7%BB%93%E6%9E%9C%EF%BC%9A"><span class="nav-number">2.4.</span> <span class="nav-text">â‘£æ¸²æŸ“ç»“æœï¼š</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%92%9C%E8%A1%A5%E5%85%85%E5%86%85%E5%AE%B9"><span class="nav-number">3.</span> <span class="nav-text">ğŸ’œè¡¥å……å†…å®¹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E8%BD%AC%E6%8D%A2%E6%96%B9%E7%A8%8B%EF%BC%9F"><span class="nav-number">3.1.</span> <span class="nav-text">å¦‚ä½•è®¾ç½®è½¬æ¢æ–¹ç¨‹ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%961%EF%BC%9A%E8%A7%A3%E5%86%B3%E7%AB%8B%E6%96%B9%E4%BD%93%E8%BE%B9%E7%BC%98%E7%9A%84%E9%94%99%E8%AF%AF"><span class="nav-number">3.2.</span> <span class="nav-text">ä¼˜åŒ–1ï¼šè§£å†³ç«‹æ–¹ä½“è¾¹ç¼˜çš„é”™è¯¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%962%EF%BC%9A%E8%BF%87%E6%BB%A4%E6%8E%89%E4%B8%80%E4%BA%9B%E5%A4%AA%E9%BB%91%E7%9A%84%E5%83%8F%E7%B4%A0"><span class="nav-number">3.3.</span> <span class="nav-text">ä¼˜åŒ–2ï¼šè¿‡æ»¤æ‰ä¸€äº›å¤ªé»‘çš„åƒç´ </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%BB%AD%E4%BC%98%E5%8C%96%E2%80%A6"><span class="nav-number">3.4.</span> <span class="nav-text">åç»­ä¼˜åŒ–â€¦</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="alexiusll"
      src="/images/apple-touch-icon-next.png">
  <p class="site-author-name" itemprop="name">alexiusll</p>
  <div class="site-description" itemprop="description">alexiusll çš„åšå®¢</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/alexiusll" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;alexiusll" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/32825146" title="Bilibili â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;32825146" rel="noopener" target="_blank"><i class="fas fa-bold fa-fw"></i>Bilibili</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">alexiusll</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">99k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">1:30</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'taK3ClN74qMXMOLjbwinsFWY-gzGzoHsz',
      appKey     : '0TM4FFbzI0dKrjeorfF42vvx',
      placeholder: "ç•™ä¸‹ä½ çš„è¯„è®ºå§!",
      avatar     : 'wavatar',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
